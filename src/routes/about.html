<svelte:head>
	<title>About</title>
</svelte:head>

<h1>About you</h1>

<p>Your id: {profile.id}</p>
<p>Your email: {profile.email}</p>

<button on:click="getUpdatedProfile()">Fetch profile</button>

<h2>Updated</h2>

<p>Updated email: {updated.email}</p>

<script>
	import { api } from '../fetcher'

	export default {
		data () {
			return {
				updated: {}
			}
		},

		methods: {
			async getUpdatedProfile () {
				const request = api.prepareGet('profile')
				const response = await fetch(...request)
				this.set({ updated: await response.json() })
			}
		},

		async preload () {
			const request = api.prepareGet('profile')
			const response = await this.fetch(...request)
			return { profile: await response.json() }
		}
	}
</script>